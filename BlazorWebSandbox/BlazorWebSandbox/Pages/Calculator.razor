@page "/calculator"
@inject HttpClient Http
<style>
.grid-container {
  display: grid;
  grid-template-columns: max-content max-content max-content;
}
.grid-item {
  border: 1px solid rgba(0, 0, 0, 0.8);
  text-align: center;
  margin:2px;
}
</style>

<h1>Calculator</h1>

<p id="displayValue">@displayValue.ToString()</p>

<div class="grid-container">
    <button class="grid-item" id="one" @onclick="@(()=>SelectNumber(1))">1</button>
    <button class="grid-item" id="two" @onclick="@(()=>SelectNumber(2))">2</button>
    <button class="grid-item" id="three" @onclick="@(()=>SelectNumber(3))">3</button>
    <button class="grid-item" id="four" @onclick="@(()=>SelectNumber(4))">4</button>
    <button class="grid-item" id="five" @onclick="@(()=>SelectNumber(5))">5</button>
    <button class="grid-item" id="six" @onclick="@(()=>SelectNumber(6))">6</button>
    <button class="grid-item" id="seven" @onclick="@(()=>SelectNumber(7))">7</button>
    <button class="grid-item" id="eight" @onclick="@(()=>SelectNumber(8))">8</button>
    <button class="grid-item" id="nine" @onclick="@(()=>SelectNumber(9))">9</button>
    <button class="grid-item" id="zero" @onclick="@(()=>SelectNumber(0))">0</button>
    <button class="grid-item" id="plus" @onclick="PlusCommand">+</button>
    <button class="grid-item" id="minus">-</button>
    <button class="grid-item" id="equals" @onclick="EqualsCommand">=</button>
    <button class="grid-item" id="clear">C</button>
</div>

@code {
    private int displayValue = 0;
    private int storedValue = 0;
    private bool equalsWasTheLastCommand = false;

    private void SelectNumber(int number)
    {
        if(equalsWasTheLastCommand || displayValue.Equals(0)){
            displayValue = number;
            equalsWasTheLastCommand = false;
            return;
        }

        displayValue = int.Parse($"{displayValue}{number}");
    }

    private void PlusCommand()
    {
        if (equalsWasTheLastCommand)
        {
            storedValue = 0;
        }

        storedValue += displayValue;
        displayValue = 0;
    }

    private void EqualsCommand()
    {
        if (equalsWasTheLastCommand)
        {
            displayValue += storedValue;
            return;
        }
     
        var lastAddedValue = displayValue;
        displayValue += storedValue;
        storedValue = lastAddedValue;
        equalsWasTheLastCommand = true;
    }
}